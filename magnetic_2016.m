%start after b_4fast was executed

% 
% A1=-0.00348 %-0.00696
% t1=13.91203 %15.4578
% t2=17.00359
 y0=4.2
% 
% for i=1:99
%     %a(i)=A1*exp(i/t1)+y0;
%     a(i)=A1*exp(i/t1)+A1*exp(i/t2)+y0;
% end


%a=[4.20000000000000 4.19798000000000 4.19596000000000 4.19394000000000 4.19192000000000 4.18990000000000 4.18788000000000 4.18586000000000 4.18384000000000 4.18182000000000 4.17980000000000 4.17778000000000 4.17576000000000 4.17373000000000 4.17171000000000 4.16969000000000 4.16767000000000 4.16565000000000 4.16363000000000 4.16161000000000 4.15959000000000 4.15757000000000 4.15555000000000 4.15353000000000 4.15151000000000 4.14949000000000 4.14747000000000 4.14545000000000 4.14343000000000 4.14141000000000 4.13939000000000 4.13737000000000 4.13535000000000 4.13333000000000 4.13131000000000 4.12929000000000 4.12727000000000 4.12524000000000 4.12322000000000 4.12120000000000 4.11918000000000 4.11716000000000 4.11514000000000 4.11312000000000 4.11110000000000 4.10908000000000 4.10706000000000 4.10504000000000 4.10302000000000 4.10100000000000 4.08980000000000 4.06959000000000 4.04939000000000 4.02918000000000 4.00898000000000 3.98878000000000 3.96857000000000 3.94837000000000 3.92816000000000 3.90796000000000 3.87551000000000 3.83510000000000 3.79469000000000 3.75429000000000 3.71388000000000 3.67347000000000 3.63306000000000 3.59265000000000 3.55224000000000 3.51184000000000 3.42857000000000 3.32755000000000 3.22653000000000 3.12551000000000 3.02449000000000 2.92347000000000 2.82245000000000 2.72143000000000 2.62041000000000 2.51939000000000 2.41020000000000 2.29908000000000 2.18796000000000 2.07684000000000 1.96571000000000 1.85459000000000 1.74347000000000 1.63235000000000 1.52122000000000 1.41010000000000 1.25714000000000 1.10000000000000 0.942860000000000 0.785710000000000 0.628570000000000 0.471430000000000 0.314290000000000 0.157140000000000 0;];
a=[4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.20000000000000 4.19082000000000 4.16051000000000 4.13020000000000 4.09990000000000 4.06959000000000 4.03929000000000 4.00898000000000 3.97867000000000 3.94837000000000 3.91806000000000 3.88367000000000 3.84327000000000 3.80286000000000 3.76245000000000 3.72204000000000 3.68163000000000 3.64122000000000 3.60082000000000 3.56041000000000 3.52000000000000 3.44898000000000 3.34796000000000 3.24694000000000 3.14592000000000 3.04490000000000 2.94388000000000 2.84286000000000 2.74184000000000 2.64082000000000 2.53980000000000 2.43265000000000 2.32153000000000 2.21041000000000 2.09929000000000 1.98816000000000 1.87704000000000 1.76592000000000 1.65480000000000 1.54367000000000 1.43255000000000 1.29683000000000 1.15091000000000 1.00499000000000 0.859070000000000 0.713150000000000 0.567230000000000 0.421320000000000 0.275400000000000 0.129480000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000 0.100000000000000;];


a(a<0) = 0;
a=a/y0;

b=fliplr(a);

figure; plot(a);

m1=[b a];
m_full=m1;
for i=2:9
    
    m_full=[m_full m1];
end

figure; plot(m_full);

field = repmat(m_full',1,720);

figure; imagesc(field);
%%
%after b_4fast was executed

r2=thr-result;
r3=r2.*field.*field;

r4=thr-r3;

%%
show_result_map_v2( r4(z_start:z_step:z_stop, phi_start:phi_step:phi_stop), angle_step, angle_aspect,  phi_start, phi_stop, phi_step, z_start, z_stop, z_step, c_map, cavity_name, test_name, mesh_size, OST_used, time_thr, time_minimum );